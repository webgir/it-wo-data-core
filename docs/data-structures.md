# IWDC — Data Structures

Система IWDC использует унифицированный набор структур данных для представления серий, моделей и длиночных характеристик оборудования. Все данные проходят через единый конвейер: XLS → CSV → JSON → Output.

## 1. Series

Объект серии определяет группу моделей и служит верхним уровнем иерархии.

Пример:
{
  "series": "VK",
  "title": "Конвекторы ВК",
  "locale": "ru"
}

## 2. Models

Модель описывает конкретную конфигурацию оборудования, связывая артикул с набором длиночных значений.

Пример:
{
  "model": "VK.65.160.2TG",
  "series": "VK",
  "title": "Конвектор VK.65.160.2TG",
  "tubes": 2,
  "height": 65,
  "depth": 160
}

## 3. Lengths

Длина — это базовая единица расчётов. Каждый объект длины содержит теплоотдачу, цену и дополнительные параметры.

Пример:
{
  "length": 1000,
  "watts": 210,
  "price": 14800
}

## 4. JSON Output Structure

Стандартный объединённый JSON:

{
  "series": "VK",
  "model": "VK.65.160.2TG",
  "lengths": [...]
}

## 5. Строгие JSON Schema

IWDC использует строгие JSON Schema (Draft 2020-12) для валидации всех структур данных. Схемы определяют:

- **Обязательные поля** (`required`)
- **Типы данных** (`type`, `integer`, `string`, `object`, `array`)
- **Паттерны** (`pattern`) для строковых полей
- **Диапазоны значений** (`minimum`, `maximum`)
- **Перечисления** (`enum`)
- **Запрет дополнительных полей** (`additionalProperties: false`)

### Доступные схемы:

- `schemas/model.schema.json` — схема для моделей
- `schemas/length.schema.json` — схема для длин
- `schemas/series.schema.json` — схема для серий
- `schemas/meta.schema.json` — схема для метаданных
- `schemas/seo.schema.json` — схема для SEO-данных

### Валидация:

Валидация обязательна перед любыми публикациями или сборкой каталога. Используется библиотека `ajv` (v8.12.0+) с поддержкой форматов даты-времени.

## 6. Правила slug и path

### Slug

**Slug** — уникальный идентификатор в формате URL-friendly строки.

**Правила для slug:**
- Только строчные буквы (a-z), цифры (0-9), дефисы (-) и точки (.)
- Паттерн: `^[a-z0-9\\-\\.]+$`
- Должен быть уникальным в рамках своей категории (models или lengths)
- Формируется из `article_base` или `article_full` с транслитерацией кириллицы

**Примеры slug:**
- `vk-55-160-2г` (для модели)
- `vk-55-160-600-2г` (для длины)

### Path

**Path** — URL-путь для веб-представления.

**Правила для path:**
- Начинается с `/`
- Содержит только строчные буквы, цифры, дефисы и точки
- Паттерн: `^/[a-z0-9\\-\\.]+(/[a-z0-9\\-\\.]+)*$`
- Структура: `/{series}/{model-slug}` для моделей, `/{series}/{model-slug}/{length}` для длин

**Примеры path:**
- `/vk/vk-55-160-2г` (для модели)
- `/vk/vk-55-160-2г/600` (для длины)

### Генерация slug и path

Функция `generateSlug(series, modelCode)`:
- Объединяет `series` и `modelCode` через точку
- Приводит к lowercase
- Заменяет все точки на дефисы

Пример: `generateSlug("VK", "ВК.55.160.2Г")` → `"vk-вк-55-160-2г"` (после транслитерации)
